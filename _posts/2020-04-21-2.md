---
layout:     post
title:      Black-Scholes模型与Greek字母
date:       2020-04-21
author:     Minjun Huang
header-img: img/tag-bg-o.jpg
catalog: true
tags:
    - R语言
    - 投资学

---

<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

## BS公式假设

- 股票价格服从均值为$\mu$，方差为$\sigma^2$的对数正态分布
- 被定价的期权是欧式期权，到期前不可行权
- 市场无交易成本或税收，所有证券无限可分
- 证券在有效期内不会产生红利
- 市场无套利机会
- 证券交易是连续的
- 无风险利率保持不变

## 推导过程

#### 前置内容

&emsp;&emsp;设0时刻的股票价格为$S_0$，T时刻的股票价格为$S_T$，假设资产价格的对数变化服从正态分布，则有$\ln S_T-\ln S_0=x \sim N(\mu,\sigma^2)$，并且$S_T = S_0 \text{e}^x$。



&emsp;&emsp;首先需要求得$\text{e}^x$的期望值，利用概率积分，可以得到
$$
\begin{aligned}\text{E}\left( \text{e}^x \right) &=\frac{1}{\sqrt{2\pi \sigma ^2}}\int_{-\infty}^{+\infty}{\text{e}^{x-\frac{\left( x-\mu \right) ^2}{2\sigma ^2}}\text{d}x}
\\
&=\frac{1}{\sqrt{2\pi \sigma ^2}}\cdot \text{e}^{\frac{\left( \mu +\sigma ^2 \right) ^2-\mu ^2}{2\sigma ^2}}\cdot \sqrt{2}\sigma \int_{-\infty}^{+\infty}{\text{e}^{-\left[ \frac{\left( x-\mu -\sigma ^2 \right)}{\sqrt{2}\sigma} \right] ^2}\text{d}\frac{x-\mu -\sigma ^2}{\sqrt{2}\sigma}}
\\
&=e^{\mu +\frac{1}{2}\sigma ^2}\end{aligned}
$$

即$\text{E}(\text{e}^x)=\text{e}^{\mu+ \frac{1}{2}\sigma^2}$。换言之，如果$\ln X \sim N(\mu,\sigma^2)$，则$\text{E}(X)=\text{e}^{\mu+\frac{1}{2}\sigma^2}$。

---

&emsp;&emsp;设随机过程$\left\\{z_t \right\\} $满足
$$
z_{t+\Delta}-z_t\sim N\left( 0,\Delta \right) ,\forall \Delta>0
$$
并且$z_t$的增量相互独立，$z_t$是关于时间$t$的连续函数，那么$\left\\{ z_t \right\\}$为布朗运动。



&emsp;&emsp;定义布朗运动的微分为


$$
\text{d}z_t=\lim_{\Delta \rightarrow 0}(z_{t+\Delta}-z_t) 
$$


根据布朗运动的定义可以求得$\text{E}_t(\text{d}z_t)=0$，并且定义$t$时刻$\text{d}z_t$的方差为$\text{d}t$，可以得到


$$
\text{d}t=\text{Var}\left( \text{d}z_t \right) =\text{E}_t\left[ \text{d}z_t-\text{E}_t\left( \text{d}z_t \right) \right] ^2=\text{E}_t\left[ \text{d}z_t \right] ^2
$$


以标准布朗运动为条件，广义的布朗运动可以定义为


$$
\text{d}x_t=\mu \text{d}t+\sigma \text{d}z_t
$$

---

&emsp;&emsp;伊藤引理：对于布朗运动$x_t$与二阶可导函数$f$，定义$y_t=f(x_t)$，那么有


$$
\begin{aligned}
\text{d}y_t&=\frac{\partial f}{\partial x}\text{d}x_t+\frac{1}{2}\frac{\partial ^2f}{\partial x^2}\text{d}x_t^2
\\
&=\frac{\partial f}{\partial x}\left( \mu \text{d}t+\sigma \text{d}z_t \right) +\frac{1}{2}\frac{\partial ^2f}{\partial x^2}\left( \mu \text{d}t+\sigma \text{d}z_t \right) ^2
\\
&=\frac{\partial f}{\partial x}\left( \mu \text{d}t+\sigma \text{d}z_t \right) +\frac{1}{2}\frac{\partial ^2f}{\partial x^2}\left( \mu ^2\text{d}t^2+2\mu \sigma \text{d}t\text{d}z_t+\sigma ^2\text{d}z_t^2 \right) 
\\
&=\left( \frac{\partial f}{\partial x}\mu +\frac{1}{2}\frac{\partial ^2f}{\partial x^2}\sigma ^2 \right) \text{d}t+\frac{\partial f}{\partial x}\sigma \text{d}z_t
\end{aligned}
$$


在进行二阶泰勒展开时，仅保留$\text{d}z_t$和$\text{d}t$项，并且$\text{d}t=(\text{d}z_t)^2$。

---

&emsp;&emsp;对于布朗运动的微分$\text{d}z_t$