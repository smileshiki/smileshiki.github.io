---
layout:     post
title:      Black-Scholes模型与Greek字母
date:       2020-04-21
author:     Minjun Huang
header-img: img/tag-bg-o.jpg
catalog: true
tags:
    - R语言
    - 投资学

---

<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

## BS公式假设

- 股票价格服从均值为$\mu$，方差为$\sigma^2$的对数正态分布
- 被定价的期权是欧式期权，到期前不可行权
- 市场无交易成本或税收，所有证券无限可分
- 证券在有效期内不会产生红利
- 市场无套利机会
- 证券交易是连续的
- 无风险利率保持不变

## 推导过程

#### 前置内容

&emsp;&emsp;设0时刻的股票价格为$S_0$，T时刻的股票价格为$S_T$，假设资产价格的对数变化服从正态分布，则有$\ln S_T-\ln S_0=x \sim N(\mu,\sigma^2)$，并且$S_T = S_0 \text{e}^x$。



&emsp;&emsp;首先需要求得$\text{e}^x$的期望值，利用概率积分，可以得到
$$
\begin{aligned}\text{E}\left( \text{e}^x \right) &=\frac{1}{\sqrt{2\pi \sigma ^2}}\int_{-\infty}^{+\infty}{\text{e}^{x-\frac{\left( x-\mu \right) ^2}{2\sigma ^2}}\text{d}x}
\\
&=\frac{1}{\sqrt{2\pi \sigma ^2}}\cdot \text{e}^{\frac{\left( \mu +\sigma ^2 \right) ^2-\mu ^2}{2\sigma ^2}}\cdot \sqrt{2}\sigma \int_{-\infty}^{+\infty}{\text{e}^{-\left[ \frac{\left( x-\mu -\sigma ^2 \right)}{\sqrt{2}\sigma} \right] ^2}\text{d}\frac{x-\mu -\sigma ^2}{\sqrt{2}\sigma}}
\\
&=e^{\mu +\frac{1}{2}\sigma ^2}\end{aligned}
$$

即$\text{E}(\text{e}^x)=\text{e}^{\mu+ \frac{1}{2}\sigma^2}$。换言之，如果$\ln X \sim N(\mu,\sigma^2)$，则$\text{E}(X)=\text{e}^{\mu+\frac{1}{2}\sigma^2}$。

---

&emsp;&emsp;设随机过程$\left\\{z_t \right\\} $满足


$$
z_{t+\Delta}-z_t\sim N\left( 0,\Delta \right) ,\forall \Delta>0
$$


其中$\Delta$为任意正数，表示连续时间，并且$z_t$的增量相互独立，$z_t$是关于时间$t$的连续函数，那么$\left\\{ z_t \right\\}$为布朗运动。



&emsp;&emsp;定义布朗运动的微分为


$$
\text{d}z_t=\lim_{\Delta \rightarrow 0}(z_{t+\Delta}-z_t) 
$$


根据布朗运动的定义可以求得$\text{E}_t(\text{d}z_t)=0$，并且定义$t$时刻$\text{d}z_t$的方差为$\text{d}t$，可以得到


$$
\text{d}t=\text{Var}\left( \text{d}z_t \right) =\text{E}_t\left[ \text{d}z_t-\text{E}_t\left( \text{d}z_t \right) \right] ^2=\text{E}_t\left[ \text{d}z_t \right] ^2
$$


以标准布朗运动为条件，广义的布朗运动可以定义为


$$
\text{d}x_t=\mu \text{d}t+\sigma \text{d}z_t
$$

---

&emsp;&emsp;伊藤引理：对于布朗运动$x_t$与二阶可导函数$f$，定义$y_t=f(x_t)$，那么有


$$
\begin{aligned}
\text{d}y_t&=\frac{\partial f}{\partial x}\text{d}x_t+\frac{1}{2}\frac{\partial ^2f}{\partial x^2}\text{d}x_t^2
\\
&=\frac{\partial f}{\partial x}\left( \mu \text{d}t+\sigma \text{d}z_t \right) +\frac{1}{2}\frac{\partial ^2f}{\partial x^2}\left( \mu \text{d}t+\sigma \text{d}z_t \right) ^2
\\
&=\frac{\partial f}{\partial x}\left( \mu \text{d}t+\sigma \text{d}z_t \right) +\frac{1}{2}\frac{\partial ^2f}{\partial x^2}\left( \mu ^2\text{d}t^2+2\mu \sigma \text{d}t\text{d}z_t+\sigma ^2\text{d}z_t^2 \right) 
\\
&=\left( \frac{\partial f}{\partial x}\mu +\frac{1}{2}\frac{\partial ^2f}{\partial x^2}\sigma ^2 \right) \text{d}t+\frac{\partial f}{\partial x}\sigma \text{d}z_t
\end{aligned}
$$


在进行二阶泰勒展开时，仅保留$\text{d}z_t$和$\text{d}t$项，并且$\text{d}t=(\text{d}z_t)^2$。

---

&emsp;&emsp;对于布朗运动的微分$\text{d}z_t$，定义随机积分为


$$
\begin{aligned}
\int_{t=0}^T{\text{d}z_t}&=\lim_{\Delta \rightarrow 0} \left[ \left( z_{\Delta}-z_0 \right) +\left( z_{2\Delta}-z_{\Delta} \right) +\cdots +\left( z_T-z_{T-\Delta} \right) \right] 
\\
&=z_T-z_0\sim N\left( 0,T \right) 
\end{aligned}
$$


而对于随机过程$\text{d}x_t=\mu \text{d}t+\sigma\text{d}z_t$，在等式两端进行积分可得


$$
\int_{t=0}^T{\text{d}x_t}=\mu \int_{t=0}^T{\text{d}t}+\sigma \int_{t=0}^T{\text{d}z_t}\Rightarrow x_T-x_0=\mu T+\sigma \int_{t=0}^T{\text{d}z_t}
$$

#### 鞅方法推导

&emsp;&emsp;假设市场中的股票价格为$S_t$，它的运动方程为


$$
\text{d}S_t=\mu S_t\text{d}t + \sigma S_t\text{d}z_t
$$


根据伊藤引理，可以得到$\ln S_t$的微分


$$
\begin{aligned}
\text{d}\left( \ln S_t \right) &=\frac{1}{S_t}\text{d}S_t-\frac{1}{2}\frac{1}{S_{t}^{2}}\text{d}S_{t}^{2}
\\
&=\mu \text{d}t+\sigma \text{d}z_t-\frac{1}{2S_{t}^{2}}\left( \mu S_t\text{d}t+\sigma S_t\text{d}z_t \right) ^2
\\
&=\left( \mu -\frac{1}{2}\sigma ^2 \right) \text{d}t+\sigma \text{d}z_t
\end{aligned}
$$


对上式两端同时求积分可得


$$
\begin{aligned}
& \int_{t=0}^T{\text{d}\left( \ln S_t \right)}=\int_{t=0}^T{\begin{array}{c}
	\left( \mu -\frac{1}{2}\sigma ^2 \right) \text{d}t\\
\end{array}}+\sigma \int_{t=0}^T{\text{d}z_t}
\\
& \Rightarrow \ln S_T-\ln S_0=\left( \mu -\frac{1}{2}\sigma ^2 \right) T+\sigma \int_{t=0}^T{\text{d}z_t} \\
& \Rightarrow S_T=S_0\text{e}^{\left( \mu -\frac{1}{2}\sigma ^2 \right) T+\sigma \int_{t=0}^T{\text{d}z_t}}
\end{aligned}
$$

根据对数正态分布的性质，容易得到$\text{E}(S_T)=S_0\text{e}^{\mu T}$



&emsp;&emsp;由于市场中不存在套利机会，一定存在某个等价鞅测度，使得股票价格满足鞅性，即$\bar{\text{E}}(S_T)=S_0\text{e}^{rT}$。此时股价

